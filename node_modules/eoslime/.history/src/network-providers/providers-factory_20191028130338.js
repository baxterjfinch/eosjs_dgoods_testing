const is = require('./../helpers/is');

const Provider = require('./provider');
const BaseProvider = require('./base-provider');

class ProvidersFactory {
    constructor(network) {
        this.provider = new Provider(network);
    }

    create() {
        const providerProxyHandler = {
            get: (obj, value) => {
                if (!obj.hasOwnProperty(value)) {
                    return this.provider[value];
                }

                return obj[value];
            },
            construct: (target, network) => {
                return new Provider(network);
            }
        }

        return new Proxy(this, providerProxyHandler);
    }

    reset(newProvider) {
        is(newProvider).instanceOf(BaseProvider);
        Object.assign(this.provider, newProvider);
    }
}

module.exports = ProvidersFactory;
