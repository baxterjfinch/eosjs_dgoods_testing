const Mocha = require('mocha');
const mochaConfig = require('./mocha-config');

const EVENTS = {
    'allFinished': 'suite end'
}

class MochaFramework {
    constructor(testFiles) {
        this.instance = new Mocha(mochaConfig);

        testFiles.forEach(testFile => {
            this.instance.addFile(testFile);
        });
    }

    on(eventName, callback) {

    }

    async runTests() {
        return new Promise((resolve, reject) => {
            const mochaRunner = this.instance.run();
            mochaRunner.run(failures => {
                process.exitCode = failures ? -1 : 0;
                if (failures) {
                    return void reject(failures)
                }

                resolve();
            });
            const r = this.instance.run();
            r.ru
        });
    }
}

module.exports = MochaFramework;
